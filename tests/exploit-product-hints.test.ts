import { describe, expect, it } from "vitest";

import { matchExploitProduct } from "~/utils/exploitProductHints";

describe("matchExploitProduct", () => {
  it("does not infer Microsoft Windows when only the platform is mentioned", () => {
    const context =
      "NorthStar C2 agent execution tested on Windows 10 19045 without mentioning the vendor.";

    expect(matchExploitProduct(context)).toBeNull();
  });

  it("still recognises Microsoft Windows when the vendor context is present", () => {
    const context =
      "This exploit targets Microsoft Windows 10 version 22H2 workstations in the environment.";

    expect(matchExploitProduct(context)).toEqual({ vendor: "Microsoft", product: "Windows" });
  });
});

