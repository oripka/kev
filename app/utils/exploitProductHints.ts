import type { ImportTaskKey } from '~/types'

type ProductHint = {
  vendor: string
  product: string
  keywords?: string[]
  patterns?: RegExp[]
}

const normaliseKeywords = (keywords: string[] | undefined): string[] => {
  if (!keywords?.length) {
    return []
  }
  return keywords
    .map(keyword => keyword.toLowerCase().trim())
    .filter(Boolean)
}

export const PRODUCT_HINTS: ProductHint[] = [
  {
    vendor: 'Microsoft',
    product: 'Windows',
    keywords: [
      'microsoft windows',
      'windows server',
      'windows 10',
      'windows 11',
      'windows 7',
      'windows xp'
    ]
  },
  {
    vendor: 'Microsoft',
    product: 'Exchange Server',
    keywords: ['microsoft exchange', 'exchange server', 'owa'],
    patterns: [/outlook web access/i, /outlook web app/i]
  },
  {
    vendor: 'Microsoft',
    product: 'SharePoint',
    keywords: ['sharepoint']
  },
  {
    vendor: 'Microsoft',
    product: 'Internet Information Services',
    keywords: ['internet information services', 'microsoft iis'],
    patterns: [/\biis\b/i]
  },
  {
    vendor: 'Cisco',
    product: 'Adaptive Security Appliance',
    keywords: ['cisco asa', 'adaptive security appliance'],
    patterns: [/anyconnect/i]
  },
  {
    vendor: 'Cisco',
    product: 'IOS XE',
    keywords: ['ios xe', 'ios-xe']
  },
  {
    vendor: 'Cisco',
    product: 'Firepower',
    keywords: ['cisco firepower']
  },
  {
    vendor: 'Citrix',
    product: 'NetScaler ADC',
    keywords: ['citrix adc', 'netscaler adc', 'citrix netscaler']
  },
  {
    vendor: 'Citrix',
    product: 'Gateway',
    keywords: ['citrix gateway']
  },
  {
    vendor: 'Fortinet',
    product: 'FortiGate',
    keywords: ['fortigate', 'fortios'],
    patterns: [/forti(web|proxy|wan)/i]
  },

  {
    vendor: 'Palo Alto Networks',
    product: 'PAN-OS',
    keywords: ['pan-os', 'pan os'],
    patterns: [/globalprotect/i]
  },
  {
    vendor: 'Ivanti',
    product: 'Connect Secure',
    keywords: ['pulse secure', 'ivanti connect secure', 'pulse connect secure']
  },
  {
    vendor: 'Ivanti',
    product: 'Endpoint Manager Mobile',
    keywords: ['endpoint manager mobile', 'epmm']
  },
  {
    vendor: 'Progress',
    product: 'MOVEit Transfer',
    keywords: ['moveit transfer']
  },
  {
    vendor: 'Progress',
    product: 'WS_FTP Server',
    keywords: ['ws_ftp server', 'ws-ftp', 'wsftp']
  },
  {
    vendor: 'F5 Networks',
    product: 'BIG-IP',
    keywords: ['big-ip', 'f5 bigip', 'f5 big-ip']
  },
  {
    vendor: 'Juniper Networks',
    product: 'Junos',
    keywords: ['junos', 'srx']
  },
  {
    vendor: 'HPE Aruba',
    product: 'EdgeConnect',
    keywords: ['aruba edgeconnect', 'silverpeak']
  },
  {
    vendor: 'VMware',
    product: 'vCenter Server',
    keywords: ['vcenter server', 'vsphere client']
  },
  {
    vendor: 'VMware',
    product: 'ESXi',
    keywords: ['vmware esxi', 'esxi host']
  },
{
    "vendor": "Acronis",
    "product": "True Image",
    "keywords": ["acronis trueimage", "acronis true image"]
  },
  {
    "vendor": "Aerohive",
    "product": "NetConfig",
    "keywords": ["aerohive netconfig"]
  },
  {
    "vendor": "Aerospike",
    "product": "Database",
    "keywords": ["aerospike database"]
  },
  {
    "vendor": "Ahsay",
    "product": "Backup",
    "keywords": ["ahsay backup"]
  },
  {
    "vendor": "AIS",
    "product": "ESEL-Server",
    "keywords": ["ais logistics", "esel-server"]
  },
  {
    "vendor": "ALLPlayer",
    "product": "ALLMediaServer",
    "keywords": ["allmediaserver"]
  },
  {
    "vendor": "AnyDesk",
    "product": "AnyDesk",
    "keywords": ["anydesk"]
  },
  {
    "vendor": "Anviz",
    "product": "CrossChex",
    "keywords": ["anviz crosschex"]
  },
  {
    "vendor": "Arista",
    "product": "Arista",
    "keywords": ["arista"]
  },
  {
    "vendor": "Artica",
    "product": "Proxy",
    "keywords": ["artica proxy"]
  },
  {
    "vendor": "Artifex Software",
    "product": "Ghostscript",
    "keywords": ["ghostscript"]
  },
  {
    "vendor": "ATutor",
    "product": "ATutor",
    "keywords": ["atutor"]
  },
  {
    "vendor": "Awind",
    "product": "SNMP Service",
    "keywords": ["awindinc", "awind"]
  },
  {
    "vendor": "Axis",
    "product": "Network Camera",
    "keywords": ["axis network camera"]
  },
  {
    "vendor": "Bludit",
    "product": "Bludit",
    "keywords": ["bludit"]
  },
  {
    "vendor": "BMC",
    "product": "Patrol Agent",
    "keywords": ["bmc patrol agent"]
  },
  {
    "vendor": "BoidCMS",
    "product": "BoidCMS",
    "keywords": ["boidcms"]
  },
  {
    "vendor": "BYOB",
    "product": "BYOB",
    "keywords": ["byob", "build your own botnet"]
  },
  {
    "vendor": "Cacti",
    "product": "Cacti",
    "keywords": ["cacti"]
  },
  {
    "vendor": "Canon",
    "product": "Printer Drivers",
    "keywords": ["canon driver"]
  },
  {
    "vendor": "Chamilo",
    "product": "Chamilo",
    "keywords": ["chamilo"]
  },
  {
    "vendor": "ChurchInfo",
    "product": "ChurchInfo",
    "keywords": ["churchinfo"]
  },
  {
    "vendor": "CMS Made Simple",
    "product": "CMS Made Simple",
    "keywords": ["cms made simple", "cmsms"]
  },
  {
    "vendor": "CMS Made Simple",
    "product": "Showtime2",
    "keywords": ["showtime2"]
  },
  {
    "vendor": "Cockpit",
    "product": "CMS",
    "keywords": ["cockpit cms"]
  },
  {
    "vendor": "CONTEC",
    "product": "SolarView",
    "keywords": ["solarview", "contec solarview"]
  },
  {
    "vendor": "CrushFTP",
    "product": "CrushFTP",
    "keywords": ["crushftp"]
  },
  {
    "vendor": "D-Link",
    "product": "Central WiFi Manager",
    "keywords": ["d-link central wifi manager", "cwm100", "cwm-100"]
  },
  {
    "vendor": "D-Link",
    "product": "DWL-2600",
    "keywords": ["dlink dwl-2600"]
  },
  {
    "vendor": "D-Tale",
    "product": "D-Tale",
    "keywords": ["d-tale"]
  },
  {
    "vendor": "Docker",
    "product": "Docker",
    "keywords": ["docker", "runc"]
  },
  {
    "vendor": "elFinder",
    "product": "elFinder",
    "keywords": ["elfinder"]
  },
  {
    "vendor": "Enlightenment",
    "product": "Enlightenment",
    "keywords": ["enlightenment"]
  },
  {
    "vendor": "Eramba",
    "product": "Eramba",
    "keywords": ["eramba"]
  },
  {
    "vendor": "EyesOfNetwork",
    "product": "EyesOfNetwork",
    "keywords": ["eyesofnetwork"]
  },
  {
    "vendor": "File Sharing Wizard",
    "product": "File Sharing Wizard",
    "keywords": ["file sharing wizard"]
  },
  {
    "vendor": "FlexDotnetCMS",
    "product": "FlexDotnetCMS",
    "keywords": ["flexdotnetcms"]
  },
  {
    "vendor": "FLIR",
    "product": "AX8",
    "keywords": ["flir ax8"]
  },
  {
    "vendor": "FortiLogger",
    "product": "FortiLogger",
    "keywords": ["fortilogger"]
  },
  {
    "vendor": "FreeSWITCH",
    "product": "FreeSWITCH",
    "keywords": ["freeswitch"]
  },
  {
    "vendor": "FusionPBX",
    "product": "FusionPBX",
    "keywords": ["fusionpbx"]
  },
  {
    "vendor": "Gambio",
    "product": "Online Webshop",
    "keywords": ["gambio"]
  },
  {
    "vendor": "GetSimpleCMS",
    "product": "GetSimpleCMS",
    "keywords": ["getsimplecms"]
  },
  {
    "vendor": "Git",
    "product": "Git",
    "keywords": ["git"]
  },
  {
    "vendor": "Git",
    "product": "Large File Storage",
    "keywords": ["git lfs", "git-lfs"]
  },
  {
    "vendor": "Gitea",
    "product": "Gitea",
    "keywords": ["gitea"]
  },
  {
    "vendor": "GitKraken",
    "product": "GitLens",
    "keywords": ["gitlens", "gitkraken gitlens"]
  },
  {
    "vendor": "GitLab",
    "product": "GitLab",
    "keywords": ["gitlab"]
  },
  {
    "vendor": "GL.iNet",
    "product": "GL.iNet",
    "keywords": ["gl.inet"]
  },
  {
    "vendor": "Gogs",
    "product": "Gogs",
    "keywords": ["gogs"]
  },
  {
    "vendor": "Grandstream",
    "product": "UCM62xx",
    "keywords": ["grandstream ucm62xx", "grandstream"]
  },
  {
    "vendor": "Greenshot",
    "product": "Greenshot",
    "keywords": ["greenshot"]
  },
  {
    "vendor": "Horde",
    "product": "Groupware",
    "keywords": ["horde"]
  },
  {
    "vendor": "HorizontCMS",
    "product": "HorizontCMS",
    "keywords": ["horizontcms"]
  },
  {
    "vendor": "Imperva",
    "product": "SecureSphere",
    "keywords": ["imperva securesphere"]
  },
  {
    "vendor": "Intelliants",
    "product": "Subrion CMS",
    "keywords": ["subrion cms", "subrion"]
  },
  {
    "vendor": "Invoice Ninja",
    "product": "Invoice Ninja",
    "keywords": ["invoice ninja"]
  },
  {
    "vendor": "InvoiceShelf",
    "product": "InvoiceShelf",
    "keywords": ["invoiceshelf"]
  },
  {
    "vendor": "IPFire",
    "product": "IPFire",
    "keywords": ["ipfire"]
  },
  {
    "vendor": "ISPConfig",
    "product": "ISPConfig",
    "keywords": ["ispconfig"]
  },
  {
    "vendor": "Ivanti",
    "product": "Connect Secure",
    "keywords": ["ivanti connect secure"]
  },
  {
    "vendor": "Jenkins",
    "product": "Jenkins",
    "keywords": ["jenkins"]
  },
  {
    "vendor": "Jorani",
    "product": "Jorani",
    "keywords": ["jorani"]
  },
  {
    "vendor": "Klog",
    "product": "Server",
    "keywords": ["klog server"]
  },
  {
    "vendor": "Laravel",
    "product": "Framework",
    "keywords": ["laravel"]
  },
  {
    "vendor": "Lexmark",
    "product": "Lexmark",
    "keywords": ["lexmark"]
  },
  {
    "vendor": "LibreNMS",
    "product": "LibreNMS",
    "keywords": ["librenms"]
  },
  {
    "vendor": "Linux",
    "product": "Kernel",
    "keywords": ["linux kernel", "netfilter"]
  },
  {
    "vendor": "LINQPad",
    "product": "LINQPad",
    "keywords": ["linqpad"]
  },
  {
    "vendor": "MagnusBilling",
    "product": "MagnusBilling",
    "keywords": ["magnusbilling"]
  },
  {
    "vendor": "MailCleaner",
    "product": "MailCleaner",
    "keywords": ["mailcleaner"]
  },
  {
    "vendor": "MajorDoMo",
    "product": "MajorDoMo",
    "keywords": ["majordomo"]
  },
  {
    "vendor": "ManageEngine",
    "product": "ADManager Plus",
    "keywords": ["manageengine admanager plus", "admanager plus"]
  },
  {
    "vendor": "ManageEngine",
    "product": "ADAudit Plus",
    "keywords": ["manageengine adaudit plus", "adaudit plus"]
  },
  {
    "vendor": "ManageEngine",
    "product": "OpManager",
    "keywords": ["manageengine opmanager", "opmanager"]
  },
  {
    "vendor": "MaraCMS",
    "product": "MaraCMS",
    "keywords": ["maracms"]
  },
  {
    "vendor": "Metabase",
    "product": "Metabase",
    "keywords": ["metabase"]
  },
  {
    "vendor": "Mida Solutions",
    "product": "eFramework",
    "keywords": ["mida solutions eframework", "mida eframework"]
  },
  {
    "vendor": "Monitorr",
    "product": "Monitorr",
    "keywords": ["monitorr"]
  },
  {
    "vendor": "Moodle",
    "product": "Moodle",
    "keywords": ["moodle"]
  },
  {
    "vendor": "MotionEye",
    "product": "Frontend",
    "keywords": ["motioneye"]
  },
  {
    "vendor": "Nagios",
    "product": "XI",
    "keywords": ["nagios xi"]
  },
  {
    "vendor": "Navigate CMS",
    "product": "Navigate CMS",
    "keywords": ["navigate cms"]
  },
  {
    "vendor": "Netgate",
    "product": "pfSense",
    "keywords": ["pfsense"]
  },
  {
    "vendor": "NetMotion",
    "product": "Mobility Server",
    "keywords": ["netmotion mobility"]
  },
  {
    "vendor": "Netsweeper",
    "product": "WebAdmin",
    "keywords": ["netsweeper"]
  },
  {
    "vendor": "NextGen Healthcare",
    "product": "Mirth Connect",
    "keywords": ["mirth connect"]
  },
  {
    "vendor": "Open Web Analytics",
    "product": "Open Web Analytics",
    "keywords": ["open web analytics", "owa"]
  },
  {
    "vendor": "OpenBSD",
    "product": "OpenBSD",
    "keywords": ["openbsd"]
  },
  {
    "vendor": "OpenBSD",
    "product": "OpenSMTPD",
    "keywords": ["opensmtpd"]
  },
  {
    "vendor": "OpenMediaVault",
    "product": "OpenMediaVault",
    "keywords": ["openmediavault"]
  },
  {
    "vendor": "OpenMRS",
    "product": "OpenMRS",
    "keywords": ["openmrs"]
  },
  {
    "vendor": "OpenPrinting",
    "product": "CUPS",
    "keywords": ["cups", "openprinting cups"]
  },
  {
    "vendor": "OpenTSDB",
    "product": "OpenTSDB",
    "keywords": ["opentsdb"]
  },
  {
    "vendor": "openSIS",
    "product": "openSIS",
    "keywords": ["opensis"]
  },
  {
    "vendor": "Optergy",
    "product": "BMS",
    "keywords": ["optergy"]
  },
  {
    "vendor": "Oracle",
    "product": "Application Testing Suite",
    "keywords": ["oracle application testing suite"]
  },
  {
    "vendor": "Oracle",
    "product": "Solaris",
    "keywords": ["oracle solaris", "sunssh"]
  },
  {
    "vendor": "Paessler",
    "product": "PRTG",
    "keywords": ["prtg", "paessler prtg"]
  },
  {
    "vendor": "Pandora FMS",
    "product": "Pandora FMS",
    "keywords": ["pandora fms"]
  },

  {
    "vendor": "phpMyAdmin",
    "product": "phpMyAdmin",
    "keywords": ["phpmyadmin"]
  },
  {
    "vendor": "Pi-hole",
    "product": "Pi-hole",
    "keywords": ["pi-hole"]
  },
  {
    "vendor": "Pimcore",
    "product": "Pimcore",
    "keywords": ["pimcore"]
  },
  {
    "vendor": "PivotX",
    "product": "PivotX",
    "keywords": ["pivotx"]
  },
  {
    "vendor": "Plantronics",
    "product": "Hub",
    "keywords": ["plantronics hub"]
  },
  {
    "vendor": "Plesk",
    "product": "myLittleAdmin",
    "keywords": ["plesk", "mylittleadmin"]
  },
  {
    "vendor": "PostgreSQL",
    "product": "PostgreSQL",
    "keywords": ["postgresql", "postgres"]
  },
  {
    "vendor": "Pretalx",
    "product": "Pretalx",
    "keywords": ["pretalx"]
  },
  {
    "vendor": "Provectus",
    "product": "Kafka UI",
    "keywords": ["kafka ui"]
  },
  {
    "vendor": "qdPM",
    "product": "qdPM",
    "keywords": ["qdpm"]
  },
  {
    "vendor": "RaspAP",
    "product": "RaspAP",
    "keywords": ["raspap"]
  },
  {
    "vendor": "rConfig",
    "product": "rConfig",
    "keywords": ["rconfig"]
  },
  {
    "vendor": "Redis",
    "product": "Redis",
    "keywords": ["redis"]
  },
  {
    "vendor": "Ricoh",
    "product": "Printer Drivers",
    "keywords": ["ricoh driver"]
  },
  {
    "vendor": "RPA Technologies",
    "product": "Mobile Mouse",
    "keywords": ["mobile mouse"]
  },
  {
    "vendor": "SaltStack",
    "product": "Salt",
    "keywords": ["saltstack", "salt api"]
  },
  {
    "vendor": "Selenium",
    "product": "Grid",
    "keywords": ["selenium server", "selenium grid"]
  },
  {
    "vendor": "Shopware",
    "product": "Shopware",
    "keywords": ["shopware"]
  },
  {
    "vendor": "Sitecore",
    "product": "Experience Manager",
    "keywords": ["sitecore", "sitecore experience manager", "sitecore xm"]
  },
  {
    "vendor": "SmarterTools",
    "product": "SmarterMail",
    "keywords": ["smartermail", "smartertools smartermail"]
  },
  {
    "vendor": "SolarWinds",
    "product": "Serv-U FTP Server",
    "keywords": ["serv-u", "servu"]
  },
  {
    "vendor": "SPIP",
    "product": "SPIP",
    "keywords": ["spip"]
  },
  {
    "vendor": "Sudo Project",
    "product": "Sudo",
    "keywords": ["sudo", "sudoedit"]
  },
  {
    "vendor": "SuiteCRM",
    "product": "SuiteCRM",
    "keywords": ["suitecrm"]
  },
  {
    "vendor": "Symmetricom",
    "product": "SyncServer",
    "keywords": ["symmetricom syncserver"]
  },
  {
    "vendor": "Synacor",
    "product": "Zimbra",
    "keywords": ["zimbra"]
  },
  {
    "vendor": "Syncovery",
    "product": "Syncovery",
    "keywords": ["syncovery"]
  },
  {
    "vendor": "TerraMaster",
    "product": "TOS",
    "keywords": ["terramaster tos", "terramaster"]
  },
  {
    "vendor": "TitanHQ",
    "product": "SpamTitan",
    "keywords": ["spamtitan"]
  },
  {
    "vendor": "Total.js",
    "product": "CMS",
    "keywords": ["total.js cms"]
  },
  {
    "vendor": "TOTOLINK",
    "product": "Wireless Routers",
    "keywords": ["totolink"]
  },
  {
    "vendor": "TP-Link",
    "product": "Archer",
    "keywords": ["tp-link archer"]
  },
  {
    "vendor": "TP-Link",
    "product": "Cloud Cameras",
    "keywords": ["tp-link cloud cameras", "tp-link nc"]
  },
  {
    "vendor": "vBulletin",
    "product": "vBulletin",
    "keywords": ["vbulletin"]
  },
  {
    "vendor": "VestaCP",
    "product": "Vesta Control Panel",
    "keywords": ["vesta", "vestacp"]
  },
  {
    "vendor": "Vinchin",
    "product": "Backup & Recovery",
    "keywords": ["vinchin backup", "vinchin"]
  },
  {
    "vendor": "VyOS",
    "product": "VyOS",
    "keywords": ["vyos"]
  },
  {
    "vendor": "Webmin",
    "product": "Webmin",
    "keywords": ["webmin"]
  },
  {
    "vendor": "X.Org Foundation",
    "product": "X Server",
    "keywords": ["xorg", "x11 server"]
  },
  {
    "vendor": "Zahir",
    "product": "Enterprise Plus",
    "keywords": ["zahir enterprise"]
  },
  {
    "vendor": "ZoneMinder",
    "product": "ZoneMinder",
    "keywords": ["zoneminder"]
  },
  {
    vendor: 'Atlassian',
    product: 'Confluence',
    keywords: ['confluence'],
    patterns: [/atlassian confluence/i]
  },
  {
    vendor: 'Atlassian',
    product: 'Jira',
    keywords: ['jira software', 'jira service desk', 'jira core'],
    patterns: [/atlassian jira/i]
  },
  {
    vendor: 'Apache',
    product: 'Log4j',
    keywords: ['log4j', 'log4shell']
  },
  {
    vendor: 'Apache',
    product: 'Struts',
    keywords: ['apache struts']
  },
  {
    vendor: 'Oracle',
    product: 'WebLogic',
    keywords: ['weblogic']
  },
  {
    vendor: 'Oracle',
    product: 'Solaris',
    keywords: ['solaris']
  },
  {
    vendor: 'SAP',
    product: 'SAP NetWeaver',
    keywords: ['sap netweaver']
  },
  {
    vendor: 'SAP',
    product: 'SAP Solution Manager',
    keywords: ['sap solman', 'solution manager']
  },
  {
    vendor: 'Adobe',
    product: 'ColdFusion',
    keywords: ['coldfusion']
  },
  {
    vendor: 'Qlik',
    product: 'Qlik Sense',
    keywords: ['qlik sense']
  },
  {
    vendor: 'Qlik',
    product: 'QlikView',
    keywords: ['qlikview']
  },
  {
    vendor: 'Commvault',
    product: 'Commvault Command Center',
    keywords: ['commvault', 'command center']
  },
  {
    vendor: 'Progress',
    product: 'WhatsUp Gold',
    keywords: ['whatsup gold', 'whats up gold']
  },
  {
    vendor: 'Zoho',
    product: 'ManageEngine ServiceDesk Plus',
    keywords: ['servicedesk plus']
  },
  {
    vendor: 'Zoho',
    product: 'ManageEngine ADManager Plus',
    keywords: ['admanager plus']
  },
  {
    vendor: 'Zoho',
    product: 'ManageEngine Endpoint Central',
    keywords: ['endpoint central', 'desktop central']
  },
  {
    vendor: 'SolarWinds',
    product: 'Serv-U Managed File Transfer',
    keywords: ['serv-u']
  },
  {
    vendor: 'JetBrains',
    product: 'TeamCity',
    keywords: ['teamcity']
  },
  {
    vendor: 'GitLab',
    product: 'GitLab',
    keywords: ['gitlab']
  },
  {
    vendor: 'Progress',
    product: 'Telerik UI',
    keywords: ['telerik']
  },
  {
    vendor: 'Ivanti',
    product: 'Neurons',
    keywords: ['ivanti neurons']
  },
  {
    vendor: 'Zoho',
    product: 'ManageEngine OpManager',
    keywords: ['opmanager']
  },
  {
    vendor: 'Zoho',
    product: 'ManageEngine ADAudit Plus',
    keywords: ['adaudit plus']
  },
  {
    vendor: 'Zoho',
    product: 'ManageEngine Password Manager Pro',
    keywords: ['password manager pro']
  },
{
    "vendor": "VMware",
    "product": "vRealize Log Insight",
    "keywords": ["vmware vrealize", "vrealize log insight"]
  },
  {
    "vendor": "VMware",
    "product": "vCenter Server",
    "keywords": ["vmware vcenter", "vsphere"]
  },
  {
    "vendor": "VMware",
    "product": "vRealize Operations Manager",
    "keywords": ["vmware vrealize operations", "vrops"]
  },
  {
    "vendor": "Geutebruck",
    "product": "G-Cam/G-Code",
    "keywords": ["geutebruck", "g-cam", "g-code"]
  },
  {
    "vendor": "OpenNetAdmin",
    "product": "OpenNetAdmin",
    "keywords": ["opennetadmin"]
  },
  {
    "vendor": "Schneider Electric",
    "product": "Pelco Endura NET55XX Encoder",
    "keywords": ["schneider electric", "pelco", "net55xx"]
  },
  {
    "vendor": "The Document Foundation",
    "product": "LibreOffice",
    "keywords": ["libreoffice"]
  },
  {
    "vendor": "Unitrends",
    "product": "Enterprise Backup",
    "keywords": ["unitrends", "unitrends backup", "ueb"]
  },
  {
    "vendor": "Xplico",
    "product": "Xplico",
    "keywords": ["xplico"]
  },
  {
    "vendor": "DenyAll",
    "product": "Web Application Firewall",
    "keywords": ["denyall"]
  },
  {
    "vendor": "Zivif",
    "product": "Camera",
    "keywords": ["zivif camera", "zivif"]
  },
  {
    "vendor": "Mercurial",
    "product": "Mercurial",
    "keywords": ["mercurial"]
  },
  {
    "vendor": "Canonical",
    "product": "Juju",
    "keywords": ["juju", "juju-run"]
  },
  {
    "vendor": "Trend Micro",
    "product": "Threat Discovery Appliance",
    "keywords": ["trend micro threat discovery"]
  },
  {
    "vendor": "SolarWinds",
    "product": "Log & Event Manager",
    "keywords": ["solarwinds lem"]
  },
  {
    "vendor": "dnaLIMS",
    "product": "dnaLIMS",
    "keywords": ["dnalims"]
  },
  {
    "vendor": "Trend Micro",
    "product": "InterScan Messaging Security",
    "keywords": ["trend micro imsva", "interscan messaging security"]
  },
  {
    "vendor": "Hapi",
    "product": "Bassmaster",
    "keywords": ["bassmaster", "hapi bassmaster"]
  },
  {
    "vendor": "Trend Micro",
    "product": "Smart Protection Server",
    "keywords": ["trend micro smart protection server"]
  },
  {
    "vendor": "NetBSD",
    "product": "NetBSD",
    "keywords": ["netbsd"]
  },
  {
    "vendor": "ExaGrid",
    "product": "Backup Appliance",
    "keywords": ["exagrid"]
  },
  {
    "vendor": "Apache",
    "product": "Jetspeed",
    "keywords": ["apache jetspeed"]
  },
  {
    "vendor": "Ubiquiti",
    "product": "airOS",
    "keywords": ["ubiquiti", "airos"]
  },
  {
    "vendor": "TP-Link",
    "product": "SC2020n",
    "keywords": ["tp-link sc2020n"]
  },
  {
    "vendor": "Red Hat",
    "product": "Automatic Bug Reporting Tool",
    "keywords": ["abrt"]
  },
  {
    "vendor": "Apple",
    "product": "Safari",
    "keywords": ["safari", "apple safari"]
  },
  {
    "vendor": "Hak5",
    "product": "WiFi Pineapple",
    "keywords": ["wifi pineapple", "hak5"]
  },
  {
    "vendor": "Libuser",
    "product": "Libuser",
    "keywords": ["libuser"]
  },
  {
    "vendor": "Apple",
    "product": "macOS",
    "keywords": ["apple os x", "macos", "os x"]
  },
  {
    "vendor": "Accellion",
    "product": "File Transfer Appliance",
    "keywords": ["accellion fta", "accellion"]
  },
  {
    "vendor": "Watchguard",
    "product": "XCS",
    "keywords": ["watchguard xcs"]
  },
  {
    "vendor": "Linux",
    "product": "Kernel",
    "keywords": ["overlayfs", "linux kernel"]
  },
  {
    "vendor": "GoAutoDial",
    "product": "GoAutoDial",
    "keywords": ["goautodial"]
  },
  {
    "vendor": "Airties",
    "product": "Router",
    "keywords": ["airties"]
  },
  {
    "vendor": "Six Apart",
    "product": "MovableType",
    "keywords": ["movabletype", "sixapart"]
  },
  {
    "vendor": "Hikvision",
    "product": "DVR",
    "keywords": ["hikvision"]
  },
  {
    "vendor": "Visual Mining",
    "product": "NetCharts Server",
    "keywords": ["visual mining", "netcharts"]
  },
  {
    "vendor": "tnftp",
    "product": "tnftp",
    "keywords": ["tnftp"]
  },
  {
    "vendor": "TWiki",
    "product": "TWiki",
    "keywords": ["twiki"]
  },
  {
    "vendor": "HP",
    "product": "Network Node Manager i",
    "keywords": ["hp network node manager", "nnmi"]
  },
  {
    "vendor": "VMTurbo",
    "product": "Operations Manager",
    "keywords": ["vmturbo"]
  },
  {
    "vendor": "Chkrootkit",
    "product": "Chkrootkit",
    "keywords": ["chkrootkit"]
  },
  {
    "vendor": "D-Link",
    "product": "Router",
    "keywords": ["d-link"]
  },
  {
    "vendor": "Belkin",
    "product": "Play N750",
    "keywords": ["belkin play n750"]
  },
  {
    "vendor": "AlienVault",
    "product": "OSSIM",
    "keywords": ["alienvault ossim"]
  },
  {
    "vendor": "Sophos",
    "product": "Web Protection Appliance",
    "keywords": ["sophos web protection"]
  },
  {
    "vendor": "QNX",
    "product": "QNX",
    "keywords": ["qnx", "ifwatchd"]
  },
  {
    "vendor": "Vtiger",
    "product": "CRM",
    "keywords": ["vtiger"]
  },
  {
    "vendor": "AVM",
    "product": "Fritz!Box",
    "keywords": ["fritz!box", "fritzbox"]
  },
  {
    "vendor": "SkyBlueCanvas",
    "product": "CMS",
    "keywords": ["skybluecanvas"]
  },
  {
    "vendor": "Supermicro",
    "product": "IPMI",
    "keywords": ["supermicro ipmi"]
  },
  {
    "vendor": "Apache",
    "product": "Roller",
    "keywords": ["apache roller"]
  },
  {
    "vendor": "Synology",
    "product": "DiskStation Manager",
    "keywords": ["synology", "diskstation manager", "dsm"]
  },
  {
    "vendor": "ZeroShell",
    "product": "ZeroShell",
    "keywords": ["zeroshell"]
  },
  {
    "vendor": "Red Hat",
    "product": "CloudForms Management Engine",
    "keywords": ["red hat cloudforms"]
  },
  {
    "vendor": "Graphite",
    "product": "Graphite",
    "keywords": ["graphite"]
  },
  {
    "vendor": "Squash",
    "product": "Squash",
    "keywords": ["squash"]
  },
  {
    "vendor": "NETGEAR",
    "product": "ReadyNAS",
    "keywords": ["netgear readynas"]
  },
  {
    "vendor": "Linksys",
    "product": "Router",
    "keywords": ["linksys"]
  },
  {
    "vendor": "HP",
    "product": "StorageWorks P4000",
    "keywords": ["hp storageworks"]
  },
  {
    "vendor": "Node.js",
    "product": "js-yaml",
    "keywords": ["nodejs", "js-yaml"]
  },
  {
    "vendor": "FreeBSD",
    "product": "FreeBSD",
    "keywords": ["freebsd"]
  },
  {
    "vendor": "Oracle",
    "product": "Java",
    "keywords": ["java applet", "java", "sun java", "java jmx", "java rmi"]
  },
  {
    "vendor": "HP",
    "product": "System Management Homepage",
    "keywords": ["hp system management homepage"]
  },
  {
    "vendor": "Foreman",
    "product": "Foreman",
    "keywords": ["foreman"]
  },
  {
    "vendor": "Mutiny",
    "product": "Mutiny",
    "keywords": ["mutiny"]
  },
  {
    "vendor": "MiniUPnP",
    "product": "MiniUPnPd",
    "keywords": ["miniupnpd"]
  },
  {
    "vendor": "GroundWork",
    "product": "Monitor",
    "keywords": ["groundwork"]
  },
  {
    "vendor": "Nagios",
    "product": "Nagios",
    "keywords": ["nagios", "nagios3"]
  },
  {
    "vendor": "Nagios",
    "product": "Remote Plugin Executor",
    "keywords": ["nagios nrpe"]
  },
  {
    "vendor": "Intel",
    "product": "Portable UPnP SDK",
    "keywords": ["libupnp", "portable upnp sdk"]
  },
  {
    "vendor": "Polycom",
    "product": "HDX",
    "keywords": ["polycom"]
  },
  {
    "vendor": "eXtplorer",
    "product": "eXtplorer",
    "keywords": ["extplorer"]
  },
  {
    "vendor": "MoinMoin",
    "product": "MoinMoin",
    "keywords": ["moinmoin"]
  },
  {
    "vendor": "Foswiki",
    "product": "Foswiki",
    "keywords": ["foswiki"]
  },
  {
    "vendor": "SSH Communications Security",
    "product": "Tectia SSH",
    "keywords": ["tectia ssh"]
  },
  {
    "vendor": "Symantec",
    "product": "Messaging Gateway",
    "keywords": ["symantec messaging gateway"]
  },
  {
    "vendor": "TestLink",
    "product": "TestLink",
    "keywords": ["testlink"]
  },
  {
    "vendor": "SparkLabs",
    "product": "Viscosity",
    "keywords": ["viscosity"]
  },
  {
    "vendor": "Tunnelblick",
    "product": "Tunnelblick",
    "keywords": ["tunnelblick"]
  },
  {
    "vendor": "OP5",
    "product": "Monitor",
    "keywords": ["op5"]
  },
  {
    "vendor": "QEMU",
    "product": "QEMU",
    "keywords": ["qemu"]
  },
  {
    "vendor": "Zope",
    "product": "Zope",
    "keywords": ["zope"]
  },
  {
    "vendor": "Plone",
    "product": "Plone",
    "keywords": ["plone"]
  },
  {
    "vendor": "CTEK",
    "product": "SkyRouter",
    "keywords": ["ctek skyrouter"]
  },
  {
    "vendor": "Oracle",
    "product": "GlassFish Server",
    "keywords": ["glassfish"]
  },
  {
    "vendor": "LifeSize",
    "product": "Room",
    "keywords": ["lifesize room"]
  },
  {
    "vendor": "HP",
    "product": "Data Protector",
    "keywords": ["hp data protector"]
  },
  {
    "vendor": "NetSupport",
    "product": "Manager",
    "keywords": ["netsupport manager"]
  },
  {
    "vendor": "SAP",
    "product": "BusinessObjects",
    "keywords": ["sap businessobjects", "axis2"]
  },
  {
    "vendor": "Redmine",
    "product": "Redmine",
    "keywords": ["redmine"]
  },
  {
    "vendor": "Oracle",
    "product": "VM Server",
    "keywords": ["oracle vm server", "ovs-agent"]
  },
  {
    "vendor": "UnrealIRCd",
    "product": "UnrealIRCd",
    "keywords": ["unrealircd"]
  },
  {
    "vendor": "Zabbix",
    "product": "Server",
    "keywords": ["zabbix"]
  },
  {
    "vendor": "DD-WRT",
    "product": "DD-WRT",
    "keywords": ["dd-wrt"]
  },
  {
    "vendor": "Oracle",
    "product": "ToolTalk",
    "keywords": ["tooltalk"]
  },
  {
    "vendor": "Apple",
    "product": "iTunes",
    "keywords": ["itunes"]
  },
  {
    "vendor": "Linux",
    "product": "udev",
    "keywords": ["udev"]
  },
  {
    "vendor": "Opera",
    "product": "Browser",
    "keywords": ["opera"]
  },
  {
    "vendor": "Pro-Watch",
    "product": "XTACACSD",
    "keywords": ["xtacacsd"]
  },
  {
    "vendor": "DNS",
    "product": "Resolver",
    "keywords": ["dns cache"]
  },
  {
    "vendor": "HP",
    "product": "Linux Imaging and Printing",
    "keywords": ["hplip"]
  },
  {
    "vendor": "Cisco",
    "product": "ClamAV",
    "keywords": ["clamav"]
  },
  {
    "vendor": "Apple",
    "product": "QuickTime",
    "keywords": ["quicktime", "qtjava"]
  },
  {
    "vendor": "Cisco",
    "product": "Snort",
    "keywords": ["snort"]
  },
  {
    "vendor": "Novell",
    "product": "NetWare",
    "keywords": ["novell netware"]
  },
  {
    "vendor": "ProFTPD",
    "product": "ProFTPD",
    "keywords": ["proftpd"]
  },
  {
    "vendor": "Apple",
    "product": "iOS",
    "keywords": ["ios", "mobilesafari"]
  },
  {
    "vendor": "Apache",
    "product": "SpamAssassin",
    "keywords": ["spamassassin"]
  },
  {
    "vendor": "Apple",
    "product": "Mail",
    "keywords": ["mail.app"]
  },
  {
    "vendor": "Google",
    "product": "Search Appliance",
    "keywords": ["google appliance"]
  },
  {
    "vendor": "GPSD",
    "product": "GPSD",
    "keywords": ["gpsd"]
  },
  {
    "vendor": "AWStats",
    "product": "AWStats",
    "keywords": ["awstats"]
  },
  {
    "vendor": "Veritas",
    "product": "NetBackup",
    "keywords": ["veritas netbackup"]
  },
  {
    "vendor": "Mercantec",
    "product": "SoftCart",
    "keywords": ["mercantec softcart"]
  },
  {
    "vendor": "Squid",
    "product": "Squid",
    "keywords": ["squid"]
  },
  {
    "vendor": "Apache",
    "product": "Subversion",
    "keywords": ["subversion", "svnserve"]
  },
  {
    "vendor": "Poptop",
    "product": "Poptop",
    "keywords": ["poptop"]
  },
  {
    "vendor": "Apple",
    "product": "QuickTime Streaming Server",
    "keywords": ["quicktime streaming server"]
  },
  {
    "vendor": "HP",
    "product": "HP-UX",
    "keywords": ["hp-ux"]
  },
  {
    "vendor": "SGI",
    "product": "Irix",
    "keywords": ["irix"]
  },
  {
    "vendor": "NTP",
    "product": "NTPd",
    "keywords": ["ntpd", "xntpd"]
  },
  {
    "vendor": "LPRng",
    "product": "LPRng",
    "keywords": ["lprng"]
  },
  {
    "vendor": "Washington University",
    "product": "ftpd",
    "keywords": ["wu-ftpd"]
  },
  {
    "vendor": "Roxy-WI",
    "product": "Roxy-WI",
    "keywords": ["roxy-wi"]
  },
{
    "vendor": "Claymore",
    "product": "Dual Miner",
    "keywords": ["claymore dual miner", "claymore"]
  },
  {
    "vendor": "phpCollab",
    "product": "phpCollab",
    "keywords": ["phpcollab"]
  },
  {
    "vendor": "GitHub",
    "product": "Enterprise Server",
    "keywords": ["github enterprise"]
  },
  {
    "vendor": "SonicWall",
    "product": "Global Management System",
    "keywords": ["sonicwall gms", "sonicwall global management system"]
  },
  {
    "vendor": "Swagger",
    "product": "CodeGen",
    "keywords": ["swagger codegen", "swagger"]
  },
  {
    "vendor": "phpFileManager",
    "product": "phpFileManager",
    "keywords": ["phpfilemanager"]
  },
  {
    "vendor": "MVPower",
    "product": "DVR",
    "keywords": ["mvpower dvr"]
  },
  {
    "vendor": "X.Org Foundation",
    "product": "X Window System",
    "keywords": ["x11"]
  },
  {
    "vendor": "ASUS",
    "product": "infosvr",
    "keywords": ["asus infosvr", "asus"]
  },
  {
    "vendor": "HP",
    "product": "Glance",
    "keywords": ["hp glance", "hp performance monitoring"]
  },
  {
    "vendor": "PhpWiki",
    "product": "PhpWiki",
    "keywords": ["phpwiki"]
  },
  {
    "vendor": "Railo",
    "product": "Railo",
    "keywords": ["railo"]
  },
  {
    "vendor": "Gitlist",
    "product": "Gitlist",
    "keywords": ["gitlist"]
  },
  {
    "vendor": "Belkin",
    "product": "Wemo",
    "keywords": ["belkin wemo"]
  },
  {
    "vendor": "Supermicro",
    "product": "IPMI",
    "keywords": ["supermicro ipmi"]
  },
  {
    "vendor": "InfiniBand",
    "product": "ibstat",
    "keywords": ["ibstat", "infiniband"]
  },
  {
    "vendor": "Wyse",
    "product": "Rapport",
    "keywords": ["wyse rapport"]
  },
  {
    "vendor": "DNS",
    "product": "Resolver",
    "keywords": ["dns cache"]
  },
  {
    "vendor": "Red Hat",
    "product": "Piranha",
    "keywords": ["redhat piranha", "red hat piranha"]
  },
  {
    "vendor": "NFS",
    "product": "mountd",
    "keywords": ["mountd"]
  },
  {
    "vendor": "Linux",
    "product": "Kernel",
    "keywords": ["linux kernel", "io_uring"]
  },
  {
    "vendor": "University of Washington",
    "product": "IMAP Server",
    "keywords": ["uow imap"]
  },
  {
    "vendor": "Matt Wright",
    "product": "guestbook.pl",
    "keywords": ["matt wright guestbook"]
  },
  {
    "vendor": "NFS",
    "product": "mountd",
    "keywords": ["mountd"]
  },
  {
    "vendor": "OpenSSH",
    "product": "SSH",
    "keywords": ["ssh"]
  },
  {
    vendor: 'Zoho',
    product: 'ManageEngine Patch Manager Plus',
    keywords: ['patch manager plus']
  },
  {
    vendor: 'MotionEye',
    product: 'MotionEye Frontend',
    keywords: ['motioneye']
  },
  {
    vendor: 'PivotX',
    product: 'CMS',
    keywords: ['pivotx']
  },
  {
    vendor: 'WPEverest',
    product: 'User Registration and Membership',
    keywords: ['user registration and membership']
  },

  {
    vendor: 'D-Tale',
    product: 'D-Tale',
    keywords: ['d-tale']
  },
  {
    vendor: 'Online Car Rental System',
    product: 'Car Rental System',
    keywords: ['car rental system']
  },
  {
    vendor: 'Invoice Ninja',
    product: 'Invoice Ninja',
    keywords: ['invoice ninja']
  },
  {
    vendor: 'InvoiceShelf',
    product: 'InvoiceShelf',
    keywords: ['invoiceshelf']
  },
  {
    vendor: 'LINQPad',
    product: 'LINQPad',
    keywords: ['linqpad']
  },
  {
    vendor: 'LibreNMS',
    product: 'LibreNMS',
    keywords: ['librenms']
  },
  {
    vendor: 'OpenPrinting',
    product: 'CUPS',
    keywords: ['cups ipp', 'openprinting cups']
  },
  {
    vendor: 'BYOB',
    product: 'Web GUI',
    keywords: ['build your own botnet', 'byob web gui']
  },
  {
    vendor: 'Gambio',
    product: 'Online Webshop',
    keywords: ['gambio']
  },
  {
    vendor: 'Sitecore',
    product: 'Experience Manager',
    keywords: ['sitecore experience manager', 'sitecore xm']
  },
  {
    vendor: 'MajorDoMo',
    product: 'MajorDoMo',
    keywords: ['majordomo']
  },
  {
    vendor: 'GL.iNet',
    product: 'Routers',
    keywords: ['gl.inet', 'glinet']
  },
  {
    vendor: 'GitKraken',
    product: 'GitLens',
    keywords: ['gitlens']
  },
  {
    vendor: 'Vinchin',
    product: 'Backup & Recovery',
    keywords: ['vinchin backup', 'vinchin recovery']
  },
  {
    vendor: 'NextGen Healthcare',
    product: 'Mirth Connect',
    keywords: ['mirth connect']
  },
  {
    vendor: 'ISPConfig',
    product: 'ISPConfig',
    keywords: ['ispconfig']
  },
  {
    vendor: 'Provectus',
    product: 'Kafka UI',
    keywords: ['kafka ui']
  },
  {
    vendor: 'Paessler',
    product: 'PRTG Network Monitor',
    keywords: ['prtg network monitor', 'paessler prtg']
  },
  {
    vendor: 'CrushFTP',
    product: 'CrushFTP Server',
    keywords: ['crushftp']
  },
  {
    vendor: 'Eramba',
    product: 'GRC',
    keywords: ['eramba']
  },
  {
    vendor: 'RaspAP',
    product: 'RaspAP',
    keywords: ['raspap']
  },
  {
    vendor: 'Greenshot',
    product: 'Greenshot',
    keywords: ['greenshot']
  },
  {
    vendor: 'Metabase',
    product: 'Metabase',
    keywords: ['metabase']
  },
  {
    vendor: 'BoidCMS',
    product: 'BoidCMS',
    keywords: ['boidcms']
  },
  {
    vendor: 'MagnusBilling',
    product: 'MagnusBilling',
    keywords: ['magnusbilling']
  },
  {
    vendor: 'Chamilo',
    product: 'Chamilo',
    keywords: ['chamilo']
  },
  {
    vendor: 'Contec',
    product: 'SolarView Compact',
    keywords: ['solarview compact']
  },
  {
    vendor: 'SuiteCRM',
    product: 'SuiteCRM',
    keywords: ['suitecrm']
  },
  {
    vendor: 'Netis',
    product: 'Routers',
    keywords: ['netis router', 'netis routers', 'netis mw5360']
  },
  {
    vendor: 'Timbuktu',
    product: 'Pro',
    keywords: ['timbuktu pro']
  },
  {
    vendor: 'Cyrus',
    product: 'IMAPD',
    keywords: ['cyrus imapd', 'cyrus imap']
  },
  {
    "vendor": "WordPress",
    "product": "Crop-image",
    "keywords": ["wordpress crop-image"]
  },
  {
    "vendor": "WordPress",
    "product": "Drag and Drop Multi File Uploader",
    "keywords": ["drag and drop multi file uploader"]
  },
  {
    "vendor": "WordPress",
    "product": "InfiniteWP Client",
    "keywords": ["infinitewp"]
  },
  {
    "vendor": "WordPress",
    "product": "Plainview Activity Monitor",
    "keywords": ["plainview activity monitor"]
  },
  {
    "vendor": "WordPress",
    "product": "Snap Creek Duplicator",
    "keywords": ["snap creek duplicator", "duplicator plugin"]
  },
  {
    "vendor": "WordPress",
    "product": "WordPress",
    "keywords": ["wordpress"]
  },
  {
    "vendor": "WordPress",
    "product": "wpDiscuz",
    "keywords": ["wpdiscuz"]
  },
  {
    "vendor": "PHP",
    "product": "PHP",
    "keywords": ["php"]
  },
]

const normalisedHintCache = new WeakMap<ProductHint, string[]>()
const keywordRegexCache = new WeakMap<ProductHint, RegExp[]>()

const escapeRegex = (value: string): string => value.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')

const buildKeywordRegex = (keyword: string): RegExp => {
  if (!keyword) {
    return /.^/
  }
  const pattern = `(^|[^a-z0-9])${escapeRegex(keyword)}([^a-z0-9]|$)`
  return new RegExp(pattern, 'i')
}

const getNormalisedKeywords = (hint: ProductHint): string[] => {
  let cached = normalisedHintCache.get(hint)
  if (!cached) {
    cached = normaliseKeywords(hint.keywords)
    normalisedHintCache.set(hint, cached)
  }
  return cached
}

const getKeywordRegexes = (hint: ProductHint): RegExp[] => {
  let cached = keywordRegexCache.get(hint)
  if (!cached) {
    const keywords = getNormalisedKeywords(hint)
    cached = keywords.map(buildKeywordRegex)
    keywordRegexCache.set(hint, cached)
  }
  return cached
}

const shouldSkipHint = (hint: ProductHint, text: string, lower: string): boolean => {
  if (hint.vendor === 'Microsoft' && hint.product === 'Windows') {
    const hasMicrosoftMention = lower.includes('microsoft')
    const hasMsBulletin = /\bms\d{2}[-_]\d{3}\b/i.test(text)
    if (!hasMicrosoftMention && !hasMsBulletin) {
      return true
    }
  }
  return false
}

export const matchExploitProduct = (
  text: string
): { vendor: string; product: string } | null => {
  if (!text) {
    return null
  }
  const lower = text.toLowerCase()

  for (const hint of PRODUCT_HINTS) {
    const keywordExpressions = getKeywordRegexes(hint)
    if (keywordExpressions.some(expression => expression.test(lower))) {
      if (shouldSkipHint(hint, text, lower)) {
        continue
      }
      return { vendor: hint.vendor, product: hint.product }
    }
    if (hint.patterns?.some(pattern => pattern.test(text))) {
      if (shouldSkipHint(hint, text, lower)) {
        continue
      }
      return { vendor: hint.vendor, product: hint.product }
    }
  }

  return null
}

export const describeTaskKey = (key: ImportTaskKey): string => {
  switch (key) {
    case 'kev':
      return 'CISA KEV catalog'
    case 'enisa':
      return 'ENISA exploited catalog'
    case 'historic':
      return 'Historic exploit dataset'
    case 'metasploit':
      return 'Metasploit catalog'
    case 'market':
      return 'Market intelligence offers'
    default:
      return key
  }
}
